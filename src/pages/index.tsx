import { GetStaticProps } from "next";
import Head from "next/head";
import Button from "../components/Button";
import ButtonGroup from "../components/ButtonGroup";
import Header from "../components/Header";
import LinkWithIcon from "../components/LinkWithIcon";
import { getBlogPostsData, getReviewPostsData } from "@/lib/posts";
import PreviewCard from "../components/PreviewCard";

interface HomepageProps {
  // I don't want this to be 'any' but I don't know how else to fix it
  blogs: Array<any>;
  reviews: Array<any>;
}

export const getStaticProps: GetStaticProps = async () => {
  let blogs = getBlogPostsData();
  let reviews = getReviewPostsData();
  blogs = JSON.parse(JSON.stringify(blogs));
  reviews = JSON.parse(JSON.stringify(reviews));

  return {
    props: {
      blogs,
      reviews,
    },
  };
};

export default function Home({ blogs, reviews }: HomepageProps) {
  console.log(reviews);
  const featuredReviews = reviews.filter((review) => review.featured === true);
  const latestReviews = reviews
    .filter((review) => review.featured !== true)
    .sort();
  return (
    <>
      <Head>
        <title>Hip Hop Season</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Header type="large" title="Welcome to Hip Hop Season">
        <p className="lead mt-4">
          Your home for <span className="underline">underground</span> Hip-Hop
          album reviews and blogs about all things related to Hip-Hop music and
          the culture.
        </p>
        <ButtonGroup>
          <Button type="primary" href="/reviews">
            Read the Reviews
          </Button>
          <LinkWithIcon href="/blog" className="color-white">
            Read the Blog
          </LinkWithIcon>
        </ButtonGroup>
      </Header>
      <section>
        <div className="container">
          <h2>Featured Reviews</h2>
          {featuredReviews.map((review) => {
            return (
              <PreviewCard
                orientation="vertical"
                key={review.id}
                post={review}
              />
            );
          })}
          <h2>Latests Reviews</h2>
          {latestReviews.map((review) => {
            return (
              <PreviewCard
                orientation="horizontal"
                key={review.id}
                post={review}
              />
            );
          })}
        </div>
      </section>
    </>
  );
}
